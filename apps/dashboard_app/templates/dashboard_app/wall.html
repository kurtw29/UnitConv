<!doctype html>
<html lang='en'>
<head>
    <meta charset='utf-8'>
    <title>Wall Communication</title>
<meta name='description' content=''>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
<link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css' integrity='sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO' crossorigin='anonymous'>
</head>
<body>
    <!--creating navigation bar at top-->
    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
        {% load static %}
        <a href='/'><img src="{% static "unit_conv_app/images/Google_closure_tools_logo.png" %}" alt='logo pic' width=60px></a>
        <h5 class="my-0 mr-md-auto font-weight-normal"><a href='/'>Unit Conversion</a></h5>
        <nav class="my-2 my-md-0 mr-md-3">
            <a class="p-2 text-dark" href="account_info">Account info</a>
            <a class="p-2 text-dark" href="feedback">Feedback</a>
            <a class="p-2 text-dark" href="subscription">Subscription</a>
            <a class="p-2 text-dark" href="conversion_upload">Conversion Upload</a>
            <a class="p-2 text-dark" href="wall">Wall</a>
        </nav>
        <a class="btn btn-outline-primary" href="/logout">Logout</a>
        </div>
      
    {% if messages %}
    {% for message in messages %}
        <ul class="messages">
            {% for message in messages %}
            <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endfor %}
    {% endif %}
    <br>

    <!--Nav-tabs for user dashboard-->
    <h4>Hello {{first_name}} {{last_name}}</h4>
    <ul class="nav nav-tabs">
        <li class="nav-item"><a class="nav-link" href="conversion_upload">Conversion Upload</a></li>
        <li class="nav-item"><a class="nav-link" href="account_info">Account info</a></li>
        <li class="nav-item"><a class="nav-link" href="feedback">Feedback</a></li>
        <li class="nav-item"><a class="nav-link" href="subscription">Subscription</a></li>
        <li class="nav-item"><a class="nav-link active" href="wall">Wall</a></li>
    </ul>

<!--Create the input form to enter "Post"-->
<!--flash error message for empty Post submission-->
<h2 class='card-header'>Wall Messages <a class='h5 text-info ml-auto' href="/dashboard">Back to dashboard</a></h2>

{% if messages %}
        <ul class="messages">
        {% for message in messages %}
            <li class="alert alert-danger {{ message.tags }}">{{ message }}</li>
        {% endfor %}
        </ul>
{% endif %}
    <!--create a form to submit Post-->
    <div class='container mt-5 mb-5'>
        <h4>Post a Message</h4>
        <form action= "post_proc" method="POST">
            {% csrf_token %}
            <textarea name="content" rows="4" cols="60"></textarea>
            <button  type='submit' class="mr-auto" style="display:block;">Post a message</button>
        </form>
    </div>
    <!--display the posted message on this wall-->
    <!--Search form, words contains in messages-->
    <!-- <form class='fom-control'>
        {% csrf_token %}
        <h5>Search: </h5>
        <input name='contains' type='text'>
        <input type=button value='Search'>
    </form>
    <div class="container">display table here</div> -->

    <div class="container">
    <ul class='list-unstyled'>
        {% for post in posts %}
            <li class='container'><h6 class='text-primary'>{{post.poster.first_name}} {{post.poster.last_name}} - <span class='p text-secondary'>{{post.created_at}}</span></h4>
            <p>{{post.post_text}}</p>
            <!--display the delete this message link-->
            <a class='text-danger' style='text-align:right;' href="delete_post/{{post.id}}">Delete</a>
            </li>
            <!--display the comments about this post-->
                <ul class='list-unstyled'>
                {% for comment in comments %}
                    {% if comment.commented_post.id == post.id%}
                    <h5>{{comment.commentor.first_name}}</h5>
                    <p>{{comment.created_at}} {{comment.comment_text}}</p>
                    <!--display the link to delete comment-->
                        {% if comment.commentor.id == request.session.id %}
                        <a href='deleteComment/{{comment.id}}'>Delete</a>
                        {% endif %}
                    {% endif %}
                {% endfor %} 
        {% endfor %}
    </div>

        <!-- <div class="container">
<h3 class='alert alert-warning'> Your posts:</h3>
<ul class='list-unstyled border border-secondary'> -->
    <!--List of all the post/message-->
    <!-- {% for post in posts %}
    {% if post.poster.id == request.session.id %}
    <li><p>{{post.post_text}}</p>
    <p class='text-right'>post.created_at</p><a href='#' class="btn btn-danger">delete</a>
 -->
    <!--comments for each of the wall post-->
    <!-- <div class="container">
    <ul class='list-unstyled border border-secondary'>
        {% for comment in comments %}
        <li class='border border-secondary'>
            <p>Date comment posted desc order, comment associated with the post
            <p class='text-right'>Date posted</p><a href='delete_post/{{post.id}}' class="btn btn-danger">Delete</a>
        </li>
        {% endfor %}
    </ul>
    </div>
    {% endif %}
   {% endfor %}
</ul></div>
</div> -->
